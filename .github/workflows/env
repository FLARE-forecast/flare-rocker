name: R package build and check

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  build-check:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    - name: Install dependencies
      run: |
        Rscript -e 'install.packages("remotes")'
        Rscript -e 'remotes::install_github(c('eco4cast/EFIstandards','rqthomas/cronR','eco4cast/neon4cast','cboettig/prov'), auth_token ='$PAT')'
    - name: Build and check package
      run: R CMD build . && R CMD check *tar.gz
